---
title: "Regresión Logística"
author: "Xavier Buenaño"
format: 
  pdf:
    toc: true
    toc-title: "Tabla de Contenidos"
    execute:
      echo: false
      warning: false
    bibliography: referencias_regresion_R.bib
    csl: apa.csl
    nocite: |
      @*
knitr: 
  opts_chunk: 
    fig.path: "figuras/"
---

```{r}
#| label: librerias
pacman::p_load(ISLR, tidyverse, tidymodels, ggvis)
theme_set(theme_bw())
```

## Datos

```{r}
#| label: datos_impago
data("Default")
datos_impago <- Default
```

## Análisis Exploratorio de Datos

```{r}
#| label: eda
summary(datos_impago)
```

Realizar gráfica de dispersión con variables en x: balance y y: ingreso (income); que se distingan las observaciones entre las personas que caen y que no caen en default.

```{r}
#| label: graf_disp
ggplot(datos_impago, aes(x = balance, y = income, colour = default)) + geom_point()
```

Una vez que determinamos que a priori la variable balance puede determinar el default, analizamos la referida variable.

```{r}
#| label: grafica_balance
ggplot(datos_impago, aes(x = default, y = balance)) + geom_boxplot()
```

### Particionamiento

```{r}
#| label: particion
set.seed(345)
conf_particionam <- initial_split(datos_impago, prop = 0.75, strata = student)
impago_training <- training(conf_particionam)
impago_testing <- testing(conf_particionam)
```

### Creación de receta (Incluir Feature Engineering)

```{r}
#| label: receta
```

### Aplicación de receta

```{r}
#| label: aplic_receta
```

### Especificación del modelo

```{r}
#| label: esp_gen_modelo
modelo_logistico <- logistic_reg() %>% 
  set_engine("glm") %>% 
  set_mode("classification")

translate(modelo_logistico)
```

### Entrenamiento del modelo

```{r}
#| label: entren_model
ml_ajuste <- modelo_logistico %>% fit(default ~ ., data = impago_training)

ml_ajuste %>% 
  pluck("fit") %>% 
  summary()

```

### Aplicación del modelo a datos de testeo

```{r}
#|label: model_test
ml_predicc <- ml_ajuste %>% 
  predict(impago_testing) %>% 
  bind_cols(impago_testing)

ml_predicc_augment <- augment(ml_ajuste, impago_testing)
```

### Evaluación del modelo

```{r}
#| label: eval_modelo
ml_predicc_metricas <- ml_predicc %>% 
  metrics(truth = default, estimate = .pred_class)

ml_predicc_metricas
```

## Referencias Bibliográficas



